<!DOCTYPE html>
<html>
<head>
    <title>The Meat Room</title>
    <script src="js/javascript.js" defer></script>
    <link rel="stylesheet" href="css/stylesheet.css">
    <link rel="stylesheet" href="https://use.typekit.net/rpj3trr.css">
</head>

<body>
    <div>
        <div>
            <div class="top-bar">
                <h1>The Meat Room</h1>
                <h6>Premium butcher</h6>
            </div>
            <div class="nav">
                <a href="home.html">
                    <img class="logoimg" src="assets/imgs/LOGO.png" alt="Logo">
                </a>
                
                <!-- Hamburger Icon for Mobile Navigation -->
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                
                <ul>
                    <li><a href="home.html">HOME</a></li>
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <li class="dropdown">
                        <a href="shop.html">SHOP</a>
                        <ul class="dropdown-content">
                            <li><a href="beef.html">Beef</a></li>
                            <li><a href="chicken.html">Chicken</a></li>
                            <li><a href="pork.html">Pork</a></li>
                            <li><a href="lamb.html">Lamb</a></li>
                        </ul>
                    </li>
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <li><a href="contact.html">CONTACT</a></li>
                </ul>
            </div>
        </div>
        
        <script>
            document.querySelector('.hamburger').addEventListener('click', function() {
                document.querySelector('.nav ul').classList.toggle('active');
            });
        </script>
        
    </div>

    <div class="content-wrapper">
        <div class="product-section2">
            <h1>POPULAR PRODUCTS</h1>
            <div class="slideshow-container" id="product-slides">
                <!-- Products will be inserted here dynamically -->
            </div>
        </div>
    </div>

    <div class="footer">
        <h2>Contact Info:</h2>
        <p>Instagram - @Themeatroom</p>
        <p>FaceBook - @Themeatroomnz</p>
        <p>Twitter - @Themeatroomnz</p>
        <p>Themeatroom@gmail.com | 0283969863 | 26 Anzac Road, Browns Bay</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('fetch_product_data.php')
                .then(response => response.json())
                .then(products => {
                    const slidesContainer = document.getElementById('product-slides');
                    const chunkSize = 4;
                    const productChunks = [];

                    // Chunk the products into groups of 4 for the slides
                    for (let i = 0; i < Object.keys(products).length; i += chunkSize) {
                        productChunks.push(Object.entries(products).slice(i, i + chunkSize));
                    }

                    productChunks.forEach((chunk, index) => {
                        const slideDiv = document.createElement('div');
                        slideDiv.className = `mySlides ${index === 0 ? 'active' : ''}`;
                        
                        chunk.forEach(([id, product]) => {
                            const productDiv = document.createElement('div');
                            productDiv.className = 'product-content';
                            productDiv.innerHTML = `
                                <a href="product.html?id=${id}">
                                    <img class="productimg" src="${product.image}" alt="${product.name}">
                                </a>
                                <div class="tabletext1">${product.name}</div>
                                <div class="tabletext2">${product.price_description}</div>
                            `;
                            slideDiv.appendChild(productDiv);
                        });

                        slidesContainer.appendChild(slideDiv);
                    });

                    // Navigation buttons
                    const prevButton = document.createElement('a');
                    prevButton.className = 'prev';
                    prevButton.innerHTML = '&#10094;';
                    prevButton.onclick = function() { plusSlides(-1); };

                    const nextButton = document.createElement('a');
                    nextButton.className = 'next';
                    nextButton.innerHTML = '&#10095;';
                    nextButton.onclick = function() { plusSlides(1); };

                    slidesContainer.appendChild(prevButton);
                    slidesContainer.appendChild(nextButton);
                })
                .catch(error => console.error('Error fetching product data:', error));
        });

        let slideIndex = 0;

        function plusSlides(n) {
            showSlides(slideIndex += n);
        }

        function showSlides(n) {
            const slides = document.getElementsByClassName("mySlides");
            if (n >= slides.length) { slideIndex = 0; }
            if (n < 0) { slideIndex = slides.length - 1; }
            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove("active");
            }
            slides[slideIndex].classList.add("active");
        }
    </script>
</body>
</html>
